<!DOCTYPE html 
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pl" lang="pl">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" />
	<title>¦rodowisko do demonstracji algorytmów rozwi±zywania kilku wybranych mechanizmów synchronizacyjnych</title>
</head>
<body>

<center>
	<font size="7"><b>¦rodowisko do demonstracji algorytmów rozwi±zywania kilku wybranych mechanizmów synchronizacyjnych</b></font>
	<br/><br/>
	<font size="5">Artur Orze³<br/>II rok Informatyka EAIiE<br/>wtorek 12.30</font>
</center>
<br/>
<br/>
<a name="Spis"/>
<font size="5"><b><i>Spis tre¶ci </i></b></font><br/>
<a href="#Temat">1. Temat projektu</a><br/>
<a href="#Koncepcja">2. Przedstawienie problemu i koncepcja rozwi±zania</a><br/>
<a href="#Mechanizmy">3. Wykorzystywane mechanizmy synchronizacyjne i inne mechanizmy systemowe</a><br/>
<a href="#Problemy">4. Opis wybranych problemów synchronizacyjnych i ich rozwi±zañ</a><br/>
<a href="#Wyniki">5. Wyniki przeprowadzonych testów i analiz</a><br/>
<a href="#Uruchomienie">6. Opis uruchomienia i instalacji</a><br/>
<a href="#Bibliografia">7. Bibliografia</a><br/>

<br/><br/>
<a name="Temat"><font size="5"><b><i>1. Temat projektu </i></b></font><br/></a>
<a href="#Spis">Powrót do spisu tre¶ci</a><br/><br/>
<font size="3">Napisaæ ¶rodowisko do demonstracji algorytmów rozwi±zywania kilku wybranych mechanizmów synchronizacyjnych. Przyk³adowe problemy: producenci/konsumenci, czytelnicy/pisarze, 5 filozofów, lotniskowiec, ¶pi±cy fryzjer itp.</font>
<br/><br/>
<a name="Koncepcja"><font size="5"><b><i>2. Przedstawienie problemu i koncepcja rozwi±zania </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<font size="3">
<p>
W ramach projektu, zgodnie z ustaleniami z prowadz±cym, zaimplementowana zosta³a ma³a biblioteka, u³atwiaj±ca korzystanie z niektórych mechanizmów synchronizacyjnych oraz zestaw funkcji umo¿liwiaj±cych mierzenie czasu spêdzonego w poszczególnych sekcjach kodu, w szczególno¶ci czasu oczekiwania na wej¶cie do sekcji krytycznej oraz czasu spêdzonego w tej sekcji. Ponadto zaimplementowanych zosta³o kilka rozwi±zañ wybranych, typowych problemów synchronizacyjnych. W zwi±zku z tym napisano dwa rozwi±zania dla ka¿dego z czterech problemów:
<ul>
	<li>producentów i konsumentów (w trzech wersjach: z wiêksz± liczb± producentów, konsumentów oraz gdy ich liczby s± równe),</li>
	<li>czytelników i pisarzy,</li>
	<li>piêciu filozofów,</li>
	<li>lotniskowca.</li>
</ul>
Ca³y projekt - zarówno biblioteka, jak i rozwi±zania wybranych problemów zosta³y napisane w jêzyku C.
</p>
<p>
Mechanizm analizy rozwi±zania zawiera proste w u¿ytkowaniu funkcje zapisuj±ce do plików (osobny plik dla ka¿dego w±tku/procesu, ka¿dy plik we wskazanym folderze) dane o punktach czasowych wa¿nych z punktu widzenia synchronizacji, tj.:
<ul>
	<li>oczekiwanie na wej¶cie do sekcji krytycznej</li>
	<li>wej¶cie do sekcji krytycznej</li>
	<li>wyj¶cie z sekcji krytycznej</li>
</ul>
Zdecydowano siê na porzucenie opakowywania wszystkich mechanizmów udostêpnianych przez system. W zamian zaimplementowane zosta³y tylko te, których u¿ytkowanie w typowych rozwi±zaniach jest przewidywalne, dziêki czemu wywo³anie kilku funkcji bêdzie mo¿na zast±piæ jednym. Wad± takiego rozwi±zania jest fakt, i¿ aby móc przeprowadziæ analizê rozwi±zania, potrzebne jest samodzielne dodanie wywo³añ funkcji loguj±cych. Zalet± za¶ - brak ograniczeñ na wybór mechanizmów synchronizacyjnych.
</p>
<p>
Po zakonczeniu testowania rozwi±zania konieczne jest wywo³anie specjalnej funkcji, która analizuje zawarto¶æ wszystkich plików z logami z podanego katalogu. Zadaniem tej funkcji jest czytanie tych plików linia po linii, wydobycie informacji o tym jakiego momentu czasowego i jakiego rodzaju zdarzenia dotyczy. Na tej podstawie wypisuje na standardowe wyj¶cie oraz do specjalnego pliku zbiorczego nastêpuj±ce informacje o poszczególnych procesach/w±tkach rozwi±zania:
<ul>
	<li>Nazwa okre¶laj±ca rodzaj w±tku/procesu podana na pocz±tku logowania</li>
	<li>Liczbê prób wej¶cia do sekcji krytycznej</li>
	<li>Liczbê wej¶æ do sekcji krytycznej</li>
	<li>Liczbê wyj¶æ z sekcji krytycznej</li>
	<li>£±czny czas oczekiwania na wej¶cie do sekcji</li>
	<li>£±czny czas spêdzony w sekcji</li>
	<li>¦redni czas oczekiwania na wej¶cie do sekcji</li>
	<li>¦redni czas spêdzony w sekcji</li>
	<li>£±czny czas pracy w±tku/procesu</li>
</ul>
Plik ze zbiorczymi danymi z analizy statystyk mo¿e zostaæ wykorzystany do stworzenia m. in. wykresów obrazuj±cych czasy dzia³ania i liczbê wykonañ poszczególnych partii kodu.
</p>
<p>
Ponadto w jêzyku Python napisano prosty skrypt, który wczytuje plik ze zbiorczymi danymi statystycznymi, a nastepnie dla poszczególnych kolumn rysuje w programie Gnuplot wykresy kolumnowe obrazuj±ce ró¿nice pomiêdzy poszczególnymi w±tkami/procesami w poszczególnych kwestiach. Skrypt o nazwie <b>wykresy.py</b> znajduje siê <a href="../wykresy.py">TUTAJ</a>. Niestety, ze wzglêdu na brak czasu nie uda³o siê zaimplementowaæ równie¿ mo¿liwo¶ci programowego porównywania ró¿nych rozwi±zañ tego samego problemu - ta kwestia musi wiêc póki co pozostaæ w rêkach u¿ytkownika oprogramowania.
</p>
<p>
Dok³adna dokumentacja biblioteki znajduje siê <a href="../lib/doc/html/index.html">TUTAJ</a>. Rozwi±zania poszczególnych problemów synchronizacyjnych zostan± krótko omówione w dalszej czê¶ci dokumentacji.
</p>

<br/>
<a name="Mechanizmy"><font size="5"><b><i>3. Wykorzystywane mechanizmy synchronizacyjne i inne mechanizmy systemowe </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<p>
Generalnie, nie ma ograniczeñ na wykorzystywane mechanizmy w rozwi±zaniach problemów. Aby umo¿liwiæ analizê czasów oraz liczby wykonañ sekcji krytycznej, nale¿y samodzielnie wywo³ywaæ odpowiednie funkcje.
</p>
<p>
W prezentowanych przyk³adowych rozwi±zaniach wykorzystane zosta³y nastêpuj±ce mechanizmy synchronizacyjne/systemowe i inne:
<ul>
	<li>semafory komunikacji miêdzyprocesowej Systemu V, funkcje: <b>ftok, semget, semctl, semop</b> - wybrane ze wzglêdu na to, ¿e w osobistym odczuciu autora s± one bardziej elastyczne i wygodniejsze w u¿yciu, ale wymagaj± kilku operacji przed u¿yciem. W zwi±zku z tym zaimplementowano odpowiednie opakowania u³atwiaj±æe pracê z nimi.</li>
	<li>pamiêæ wspólna komunikacji miêdzyprocesowej Systemu V, funkcje: <b>ftok, shmget, shmctl, shmat, shmdt</b> - podobnie, jak wy¿ej.</li>
	<li>w±tki standardu POSIX, funkcje: <b>pthread_create, pthread_attr_init, pthread_attr_setdetachstate, pthread_kill</b> - wykorzystywane przy rozwi±zaniach opartych o w±tki. Tworzenie w±tku zosta³o opakowane ze wzglêdu na potrzebê tworzenia w±tków od³±czonych.</li>
	<li>mutexy oraz zmienne warunkowe standardu POSIX, funkcje: <b>pthread_mutex_init, pthread_mutex_destroy, pthread_mutex_lock, pthread_mutex_unlock, pthread_cond_init, pthread_cond_destroy, pthread_cond_signal, pthread_cond_wait</b> - aby móc stosowaæ rozwi±zania oparte o monitory</li>
	<li>blokady odczytu/zapisu dla problemu czytelników i pisarzy, funkcje: <b>pthread_rwlock_init, pthread_rwlock_rdlock, pthread_rwlock_wrlock, pthread_rwlock_unlock, pthread_rwlock_destroy</b> - specjalnie stworzony dla tego problemu mechanizm idealny do zaprezentowania jego dzia³ania</li>
	<li>funkcje dla danych w³asnych w±tków: <b>pthread_key_create, pthread_key_delete, pthread_setspecific, pthread_getspecific</b></li>
	<li>funkcje systemowe do pracy z plikami: <b>open, close, unlink, remove</b> przy tworzeniu pliku z zapewnieniem, ¿e takowy nie istnieje, oraz do usuwania plików</li>
	<li>bardziej zaawansowane operacje na plikach i katalogach do pracy ze statystykami, funkcje: <b>fopen, fprintf, fscanf, fclose, opendir, readdir, closedir, stat</b></li>
	<li>funkcje do pracy z tablicami znaków pomocne przy tworzeniu statystyk: <b>sprintf, strcpy, strcmp, strcat, strlen, strtok</b></li>
	<li>pomiar czasu do zapisu momentu logowania: <b>gettimeofday</b></li>
	<li>sygnaly do koñczenia dzia³ania programów: <b>signal, sigprocmask, sigfillset, sigdelset, sigsuspend, kill</b></li>
	<li>funkcja pobieraj±ca TID w±tku/procesu oraz PID procesu: <b>syscall, getpid</b></li>
	<li>mechanizm elipsy przy tworzeniu semaforów: <b>va_start, va_arg, va_end</b></li>
</ul>
Dla ka¿dego z mechanizmów powsta³y odpowiednie struktury danych lub te¿ aliasy dla nazw typów (s± krótsze i kompatybilne z ca³± bibliotek± pod wzglêdem jêzyka).
</p>
<p>
Ze wzglêdu na mnogo¶æ operacji potrzebn± przy rozpoczêciu korzystania z semaforów i pamiêci wspólnej IPC Systemu V zdecydowano o implementacji funkcji wykonuj±cych wszelkie potrzebne operacje zarówno przy tworzeniu jak i usuwaniu dla typowych zastosowañ za programistê. Dziêki temu, przy wywo³aniu funkcji tworz±cej zestaw semaforów mo¿liwa jest natychmiastowa inicjalizacja ich warto¶ci, a tak¿e zmiana ich warto¶ci i usuniêcie/od³±czenie zbioru semaforów za pomoc± funkcji z biblioteki. W przypadku tworzenia pamiêci wspólnej, mo¿liwe jest natychmiastowe pod³±czenie, za¶ w przypadku jej zwalniania - równie¿ usuniêcie, w zale¿no¶ci od warto¶ci jednego z parametrów. Ponadto zaimplementowana zosta³a mo¿liwo¶æ tworzenia w±tku od³±czonego bez konieczno¶ci wywo³ywania dodatkowych funkcji samemu.
</p>
<br/>
<a name="Problemy"><font size="5"><b><i>4. Opis wybranych problemów i ich rozwi±zañ </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<p>
Zaimplementowane rozwi±zania s± ogólnie znane, przedstawione w ksi±¿ce <i>Programowanie wspó³bie¿ne i rozproszone...</i>, a ponadto nie s± one g³ównym celem tego projektu, st±d zdecydowano siê pomin±æ szczegó³owe opisy rozwi±zañ, a jedynie przedstawiæ ich symboliczn± ideê. W zamian, w nastêpnym rozdziale przedstawione zostan± wykresy powsta³e wskutek analizy napisanych rozwi±zañ z wykorzystaniem wspomnianego skryptu.
</p>
<font size="4"><i>a) Problem producentów i konsumentów. </i></font>
<p>
Cytuj±c Wikipediê: <i>"W problemie wystêpuj± dwa rodzaje procesów: producent i konsument, którzy dziel± wspólny zasób - bufor dla produkowanych (konsumowanych) jednostek. Zadaniem producenta jest wytworzenie produktu, umieszczenie go w buforze i rozpoczêcie pracy od nowa. W tym samym czasie konsument ma pobraæ produkt z bufora. Problemem jest taka synchronizacja procesów, ¿eby producent nie dodawa³ nowych jednostek gdy bufor jest pe³ny, a konsument nie pobiera³ gdy bufor jest pusty.
	Rozwi±zaniem dla producenta jest u¶pienie procesu w momencie gdy bufor jest pe³ny. Pierwszy konsument, który pobierze element z bufora budzi proces producenta, który uzupe³nia bufor. W analogiczny sposób usypiany jest konsument próbuj±cy pobraæ z pustego bufora."</i>
</p>
<p>
Zaimplementowane rozwi±zania bêd± poprawne dla przypadku, gdy bufor ma ograniczony rozmiar, dla dowolnej liczby producentów i konsumentów. Rozwi±zania:
<ul>
	<li>na procesach, z wykorzystaniem semaforów wskazuj±cych czy s± wolne/pe³ne miejsca w buforze, oraz pamiêci wspólnej jako bufora</li>
	<ul>
		<li><a href="../PK_p/src/PK_p_a.c">PK_p_a.c</a> - rozwi±zanie dla 3 producentów i 5 konsumentów</li>
		<li><a href="../PK_p/src/PK_p_b.c">PK_p_b.c</a> - rozwi±zanie dla 5 producentów i 3 konsumentów</li>
		<li><a href="../PK_p/src/PK_p_c.c">PK_p_c.c</a> - rozwi±zanie dla 4 producentów i 4 konsumentów</li>
	</ul>
	<li>na w±tkach, za pomoc± mechanizmu monitorów (mutexy i zmienne warunkowe) dla grup producentów i konsumentów</li>
	<ul>
		<li><a href="../PK_m/src/PK_m_a.c">PK_m_a.c</a> - rozwi±zanie dla 3 producentów i 5 konsumentów</li>
		<li><a href="../PK_m/src/PK_m_b.c">PK_m_b.c</a> - rozwi±zanie dla 5 producentów i 3 konsumentów</li>
		<li><a href="../PK_m/src/PK_m_c.c">PK_m_c.c</a> - rozwi±zanie dla 4 producentów i 4 konsumentów</li>
	</ul>
</ul>
</p>
<font size="4"><i>b) Problem czytelników i pisarzy. </i></font>
<p>
Cytuj±c Wikipediê: <i>"W problemie czytelników i pisarzy zasób jest dzielony pomiêdzy dwie grupy procesów: czytelnicy - wszystkie procesy niedokonuj±ce zmian w zasobie, pisarze - pozosta³e procesy. Jednoczesny dostêp do zasobu mo¿e uzyskaæ dowolna liczba czytelników. Pisarz mo¿e otrzymaæ tylko dostêp wy³±czny. Równocze¶nie z pisarzem dostêpu do zasobu nie mo¿e otrzymaæ ani inny pisarz, ani czytelnik, gdy¿ mog³oby to spowodowaæ b³êdy."</i>
</p>
<p>
Zaimplementowane rozwi±zania oparte s± o mechanizm blokad odczytu/zapisu. Rozwi±zania:
<ul>
	<li>na procesach, z wykorzystaniem semaforów wskazuj±cych czy s± wolne miejsca w czytelni, do wzajemnego wykluczania pisarzy oraz jako przedsionek dla pisarzy, oraz pamiêci wspólnej jako obiektu chronionego</li>
	<ul>
		<li><a href="../CP_p/src/CP_p.c">CP_p.c</a> - rozwi±zanie dla 5 czytelników i 3 pisarzy</li>
	</ul>
	<li>na w±tkach, za pomoc± blokady odczytu/zapisu - mechanizmu stworzonego specjalnie na potrzeby tego problemu</li>
	<ul>
		<li><a href="../CP_m/src/CP_m.c">CP_m.c</a> - rozwi±zanie dla 5 czytelników i 3 pisarzy</li>
	</ul>
</ul>
</p>
<font size="4"><i>c) Problem piêciu filozofów. </i></font>
<p>
Cytuj±c Wikipediê: <i>Piêciu filozofów siedzi przy stole i ka¿dy wykonuje jedn± z dwóch czynno¶ci - albo je, albo rozmy¶la. Stó³ jest okr±g³y, przed ka¿dym z nich znajduje siê miska ze spaghetti, a pomiêdzy ka¿d± s±siaduj±c± par± filozofów le¿y widelec, a wiêc ka¿da osoba ma przy sobie dwie sztuki - po swojej lewej i prawej stronie. Poniewa¿ jedzenie potrawy jest trudne przy u¿yciu jednego widelca, zak³ada siê, ¿e ka¿dy filozof korzysta z dwóch. Dodatkowo nie ma mo¿liwo¶ci skorzystania z widelca, który nie znajduje siê bezpo¶rednio przed dan± osob±. roblem ucztuj±cych filozofów jest czasami przedstawiany przy u¿yciu ry¿u, który musi byæ jedzony dwiema pa³eczkami, co lepiej obrazuje sytuacjê. Filozofowie nigdy nie rozmawiaj± ze sob±, co stwarza zagro¿enie zakleszczenia w sytuacji, gdy ka¿dy z nich zabierze lewy widelec i bêdzie czeka³ na prawy (lub na odwrót).</i>
</p>
<p>
Zaimplementowane rozwi±zania bêd± dzia³aæ poprawnie, w wersji z lokajem. Rozwi±zania:
<ul>
	<li>na procesach, z wykorzystaniem semaforów jako widelcy, a tak¿e jeden jako lokaj</li>
	<ul>
		<li><a href="../F5_p/src/F5_p.c">F5_p.c</a></li>
	</ul>
	<li>na w±tkach, za pomoc± monitora na widelce, oraz dodatkowego monitora bêd±cego lokajem</li>
	<ul>
		<li><a href="../F5_m/src/F5_m.c">F5_m.c</a></li>
	</ul>
</ul>
</p>
<font size="4"><i>d) Lotniskowiec. </i></font>
<p>
Cytuj±c ksi±¿kê <i>Programowanie wspó³bie¿ne i rozproszone...</i>: <i>"Lotniskowiec ma pok³ad o pojemno¶ci N samolotów oraz pas startowy. Pas startowy jest konieczny do startowania i l±dowania samolotów, a mo¿e z niego korzystaæ w danej chwili tylko jeden samolot. Gdy liczba samolotów na lotniskowcu jest mniejsza ni¿ K (0 &lt; K &le; N), priorytet w dostêpie do pasa startowego maj± samoloty l±duj±ce, w przeciwnym razie startuj±ce. (...) Samolotów mo¿e byæ wiêcej ni¿ N, wówczas ich czê¶æ jest zawsze w powietrzu."</i>
</p>
<p>
Rozwi±zania:
<ul>
	<li>na procesach, z wykorzystaniem semaforów wstrzymuj±cych samoloty startuj±ce i l±duj±ce oraz chroni±ce pamiêæ wspóln±</li>
	<ul>
		<li><a href="../L_p/src/L_p.c">L_p.c</a> - rozwi±zanie z 10 samolotami, 10 miejscami na lotniskowcu oraz sta³± K = 5</li>
	</ul>
	<li>na w±tkach, za pomoc± monitora chroni±cego dostêpu do lotniskowca (odpowiedni mutex oraz zmienne warunkowe dla chc±cych startowaæ i l±dowaæ)</li>
	<ul>
		<li><a href="../L_m/src/L_m.c">L_m.c</a> - rozwi±zanie z 10 samolotami, 10 miejscami na lotniskowcu oraz sta³± K = 5</li>
	</ul>
</ul>
</p>
<br/>
<a name="Wyniki"><font size="5"><b><i>5. Wyniki przeprowadzonych testów i analiz </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<p>
W wyniku uruchomienia programu pod k±tem przeprowadzenia analizy, po wys³aniu sygna³u SIGINT, na ekranie wypisane zostan± informacje o poszczególnych w±tkach/procesach. Przyk³adowy wydruk wygl±da nastêpuj±co: 
<br/>
<img border=0 width=450 height=700 src="wydruk.png">
<br/>
Za¶ zawarto¶æ pliku <b>log.log</b> po wykonaniu jednego z rozwi±zañ wygl±da tak:
<br/>
<img border=0 width=530 height=130 src="log.png">
<br/>
Plik ten mo¿na wykorzystaæ do wygenerowania wykresów za pomoc± do³±czonego skryptu.
</p>
<p>
Dla przyk³adowych rozwi±zañ wygenerowano w³a¶nie takie  wykresy - s± one przedstawione parami: po lewej znajduj± siê wykresy odpowiadaj±ce rozwi±zaniom opartym na procesach i semaforach/pamiêci wspólnej, za¶ po prawej wykresy dla rozwi±zañ wielow±tkowych na monitorach/blokadach odczytu/zapisu. 
</p>
<font size="4"><i>a) Problem producentów i konsumentów - 3 producentów i 5 konsumentów</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/1.png">
<img border=0 width=600 height=307 src="PK_m_a/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/2.png">
<img border=0 width=600 height=307 src="PK_m_a/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/3.png">
<img border=0 width=600 height=307 src="PK_m_a/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/4.png">
<img border=0 width=600 height=307 src="PK_m_a/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/5.png">
<img border=0 width=600 height=307 src="PK_m_a/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/6.png">
<img border=0 width=600 height=307 src="PK_m_a/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_a/7.png">
<img border=0 width=600 height=307 src="PK_m_a/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="PK_p_a/8.png">
<img border=0 width=600 height=307 src="PK_m_a/8.png"><br/>
</center>
<p>
Szczególnie dla rozwi±zania na procesach (dla wykresów czasów oczekiwania równie¿ i dla rozwi±zania wielow±tkowego) zauwa¿yæ mo¿na ³atwo, ¿e ze wzglêdu na wiêksz± liczbê konsumentów, producenci praktycznie nie musz± czekaæ na dostêp do sekcji krytycznej, za¶ konsumenci - tak. W rozwi±zaniu wielow±tkowym nie widaæ jednak tego a¿ tak bardzo - co prawda czas oczekiwania jest znacz±co wiêkszy, jednak liczba wej¶æ do sekcji jest niemal taka sama, jak dla producentów - mo¿e to ¶wiadczyæ o m. in. b³êdnej implementacji tego rozwi±zania lub po prostu wynikaæ z takiej natury rozwi±zania. Na uwagê zas³uguje jednak fakt du¿o szybszego dzia³ania w±tków w porównaniu z procesami przy podobnej liczbie wej¶æ do sekcji i ³±cznym czasie dzia³ania - czasy oczekiwania s± do kilku razy krótsze.
</p>
<font size="4"><i>b) Problem producentów i konsumentów - 5 producentów i 3 konsumentów</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/1.png">
<img border=0 width=600 height=307 src="PK_m_b/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/2.png">
<img border=0 width=600 height=307 src="PK_m_b/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/3.png">
<img border=0 width=600 height=307 src="PK_m_b/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/4.png">
<img border=0 width=600 height=307 src="PK_m_b/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/5.png">
<img border=0 width=600 height=307 src="PK_m_b/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/6.png">
<img border=0 width=600 height=307 src="PK_m_b/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_b/7.png">
<img border=0 width=600 height=307 src="PK_m_b/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="PK_p_b/8.png">
<img border=0 width=600 height=307 src="PK_m_b/8.png"><br/>
</center>
<p>
Podobnie jak poprzednio, ale na korzy¶æ konsumentów przemawiaj± czasy oczekiwania na wej¶cie do sekcji krytycznej - producenci szyciej produkuj±, ni¿ konsumenci s± w stanie konsumowaæ produkty. I znów w±tki dzia³a szybciej - osi±gniêto mniejszy czas oczekiwania na wej¶cie do sekcji.
</p>
<font size="4"><i>c) Problem producentów i konsumentów - 4 producentów i 4 konsumentów</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/1.png">
<img border=0 width=600 height=307 src="PK_m_c/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/2.png">
<img border=0 width=600 height=307 src="PK_m_c/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/3.png">
<img border=0 width=600 height=307 src="PK_m_c/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/4.png">
<img border=0 width=600 height=307 src="PK_m_c/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/5.png">
<img border=0 width=600 height=307 src="PK_m_c/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/6.png">
<img border=0 width=600 height=307 src="PK_m_c/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="PK_p_c/7.png">
<img border=0 width=600 height=307 src="PK_m_c/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="PK_p_c/8.png">
<img border=0 width=600 height=307 src="PK_m_c/8.png"><br/>
</center>
<p>
W tym przypadku czasy oczekiwania dla obu rodzajów w±tków/procesów s± porównywalne - tempo produkcji i konsumpcji jest zbli¿one. Co do jako¶ci rozwi±zañ - napewno czasy oczekiwania i pracy s± mniejsze w rozwi±zaniu wielow±tkowym, ale mo¿e to wynikaæ w³asnie z faktu stosowania w±tków.
</p>
<font size="4"><i>d) Problem czytelników i pisarzy - 5 czytelników, 3 pisarzy</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/1.png">
<img border=0 width=600 height=307 src="CP_m/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/2.png">
<img border=0 width=600 height=307 src="CP_m/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/3.png">
<img border=0 width=600 height=307 src="CP_m/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/4.png">
<img border=0 width=600 height=307 src="CP_m/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/5.png">
<img border=0 width=600 height=307 src="CP_m/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/6.png">
<img border=0 width=600 height=307 src="CP_m/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="CP_p/7.png">
<img border=0 width=600 height=307 src="CP_m/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="CP_p/8.png">
<img border=0 width=600 height=307 src="CP_m/8.png"><br/>
</center>
<p>
Z przedstawionych wykresów wynika jasno, ¿e rodzaj w±tku nie wp³ywa w jaki¶ sposób na to z jak± czestotliwo¶ci± ma on dostêp do sekcji krytycznej. Czasy oczekiwania na wej¶cie do sekcji krytycznej s± wiêksze w rozwi±zaniu wielow±tkowym, jednak czasy pracy w tej sekcji s± ju¿ porównywalne. W przypadku rozwi±zania na procesach wydaje siê, ¿e niewielki przywilej mog± posiadaæ pisarze, których jest mniej, za¶ w przypadku rozwi±zania wielow±tkowego - jest odwrotnie, co wydaje siê mieæ wiêkszy sens zwa¿ywszy na fakt, ¿e pisarz wymaga dostêpu wy³±cznego.
</p>
<font size="4"><i>e) Problem piêciu filozofów</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/1.png">
<img border=0 width=600 height=307 src="F5_m/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/2.png">
<img border=0 width=600 height=307 src="F5_m/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/3.png">
<img border=0 width=600 height=307 src="F5_m/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/4.png">
<img border=0 width=600 height=307 src="F5_m/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/5.png">
<img border=0 width=600 height=307 src="F5_m/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/6.png">
<img border=0 width=600 height=307 src="F5_m/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="F5_p/7.png">
<img border=0 width=600 height=307 src="F5_m/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="F5_p/8.png">
<img border=0 width=600 height=307 src="F5_m/8.png"><br/>
</center>
<p>
W tym przypadku oba rozwi±zania wydaj± siê byæ bardzo poprawne - dziêki zastosowaniu lokaja ¿aden z filozofów nie jest uprzywilejowany. ¦wiadcz± o tym bardzo zbli¿one czasy oczekiwania i jedzenia. Jednak¿e, z tych samych wykresów wynika tak¿e, ¿e rozwi±zanie z monitorami ma du¿o wy¿sz± z³o¿ono¶æ - czas oczekiwania na wej¶cie do sekcji krytycznej jest do 6 razy wiêkszy przy identycznym czasie w niej spêdzonym.
</p>
<font size="4"><i>f) Problem lotniskowca - 10 samolotów, 10 miejsc na lotniskowcu, K = 5</i></font>
<center>
<p>Liczba prób wej¶cia do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/1.png">
<img border=0 width=600 height=307 src="L_m/1.png"><br/>
<p>Liczba wej¶æ do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/2.png">
<img border=0 width=600 height=307 src="L_m/2.png"><br/>
<p>Liczba wyj¶æ z sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/3.png">
<img border=0 width=600 height=307 src="L_m/3.png"><br/>
<p>£±czny czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/4.png">
<img border=0 width=600 height=307 src="L_m/4.png"><br/>
<p>£±czny czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/5.png">
<img border=0 width=600 height=307 src="L_m/5.png"><br/>
<p>¦redni czas oczekiwania na wej¶cie do sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/6.png">
<img border=0 width=600 height=307 src="L_m/6.png"><br/>
<p>¦redni czas pracy w sekcji krytycznej</p>
<img border=0 width=600 height=307 src="L_p/7.png">
<img border=0 width=600 height=307 src="L_m/7.png"><br/>
<p>£±czny czas pracy w±tku</p>
<img border=0 width=600 height=307 src="L_p/8.png">
<img border=0 width=600 height=307 src="L_m/8.png"><br/>
</center>
<p>
Rozwi±zanie oparte o monitory wymaga du¿o mniej operacji - dziêki temu przy takim samym czasie dzia³ania programu uda³o siê odnotowaæ du¿o wiêcej prób dostania siê do pasa przez samoloty. Jednak¿e, czasy oczekiwania na ten pas s± bardzo du¿e w porównaniu z odpowiadaj±cymi im czasami dla rozwi±zania opartego o semafory. ¦wiadczyæ to mo¿e o z³ej implementacji tego rozwi±zania - dane wspólne w±tków s± chronione przez monitor lotniskowca i to mo¿e byæ przyczyn± takich rezultatów.
</p>
<p>
Wszystkie testy zosta³y przeprowadzone na komputerze osobistym z systemem Xubuntu 12.04 z j±drem Linuxa 3.2.0.25.27, procesorem Intel Core i3 - 2-rdzeniowy z Hyper Threading, 4GB pamiêci RAM.
</p>
<br/>
<a name="Uruchomienie"><font size="5"><b><i>6. Opis uruchomienia i instalacji </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<p>
Do ¼róde³ zarówno biblioteki, jak i ka¿dego rozwi±zania do³±czany jest odpowiedni plik makefile, który po wywo³aniu polecenia <b>make</b> kompiluje bibliotekê do pliku <b>libsync.so</b>, za¶ rozwi±zania problemów synchronizacyjnych do odpowiednich plików wykonywalnych. Ca³o¶æ zosta³a napisana tak, aby przy zachowaniu struktury katalogów mo¿na spokojnie uruchamiaæ pliki wykonywalne bez dodatkowych operacji czy parametrów. Przyk³adowo, po skompilowaniu rozwi±zania problemu czytelników i pisarzy w wersji wykorzystuj±cej semafory wystarczy wywo³aæ polecenie:  <code><b>./CP_p</b></code> z poziomu katalogu <b>CP_p</b>.
</p>
<p>
Ka¿de z rozwi±zañ zak³ada istnienie katalogu <b>log</b> na tym samym poziomie, co plik wykonywalny. W tym folderze tworzone s± pliki z danymi statystycznymi.
<p>
</p>
Uruchomienie skryptu rysuj±cego wykresy nastêpuje poprzez podanie jako jego jedynego argumentu pliku z logiem zbiorczym po wykonaniu analizy statystyk. Napisane rozwi±zania umieszczaj± taki plik bezpo¶rednio w swoim katalogu domowym, a jego nazw± jest <b>log.log</b>, tak wiêc przyk³adowe uruchomienie skryptu dla tego samego problemu, co wcze¶niej nastêpuje poleceniem: <code><b>./wykresy.py ./CP_p/log.log</b></code> z poziomu katalogu g³ównego projektu.
</p>
<br/>
<a name="Bibliografia"><font size="5"><b><i>7. Bibliografia </i></b></font></a>
<br/><a href="#Spis">Powrót do spisu tre¶ci</a><br/>
<p>
<ul style='margin-left:15px'>
	<li>Z. Weiss, T. Gru¼lewski "Programowanie wspó³bie¿ne i rozproszone w przyk³adach i zadaniach"</li>
	<li><a href="http://pl.wikipedia.org/wiki/Problem_producenta_i_konsumenta">Wikipedia - problem producentów i konsumentów</a></li>
	<li><a href="http://pl.wikipedia.org/wiki/Problem_czytelnik%C3%B3w_i_pisarzy">Wikipedia - problem czytelników i pisarzy</a></li>
	<li><a href="http://pl.wikipedia.org/wiki/Problem_ucztuj%C4%85cych_filozof%C3%B3w">Wikipedia - problem piêciu filozofów</a></li>
</ul>
</p>
</font>
</body>
</html>
